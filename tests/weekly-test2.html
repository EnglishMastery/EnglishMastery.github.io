<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>English Idioms Quiz</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Marcellus&family=Poppins:wght@400;700&display=swap');

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Poppins', sans-serif;
      padding: 20px;
      background-color: #FAEBD7; /* Light background color */
      max-width: 1200px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    h1 {
      font-family: 'Marcellus', serif;
      font-size: 20px;
      text-align: center;
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 700;
    }
    .user-info {
      text-align: center;
      margin-bottom: 20px;
    }
    .user-info input {
      font-family: 'Poppins', sans-serif;
      margin-top: 5px; 
      padding: 8px 12px; 
      width: 250px;
      border: 2px solid #ccc;
      border-radius: 20px; /* More rounded */
      outline: none;
      font-size: 14px;
    }
    .quiz-container {
      margin-bottom: 40px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      background-color: #fff;
    }
    .question-title {
      font-weight: bold;
      color: #2c3e50;
      font-size: 18px;
      margin-bottom: 15px;
      text-align: center;
    }
    .question {
      padding: 15px;
      margin-bottom: 15px;
      background-color: #fff;
      border-radius: 8px;
      text-align: center;
      position: relative;
      border: 1px solid transparent;
    }
    .question p {
      font-weight: bold;
      margin-bottom: 10px;
      color: #2c3e50;
      font-size: 16px;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 10px;
      margin-top: 5px;
    }
    .options label {
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background-color: #f5f5f5;
      border: 1px solid #ddd;
      padding: 6px 10px;
      border-radius: 5px;
      width: calc(50% - 5px);
      box-sizing: border-box;
      font-size: 14px;
      font-family: 'Poppins', sans-serif;
    }
    .options input[type="radio"] {
      margin-right: 5px;
    }
    .error-icon {
      display: none; 
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 20px;
      color: #dc3545;
    }
    .success-icon {
      display: none;
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 20px;
      color: #28a745;
    }
    .text-container {
      margin-bottom: 20px;
      font-size: 16px;
      line-height: 1.6;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
    }
    .text-container p {
      display: inline;
      text-align: center;
    }
    .text-container .input-container {
      position: relative;
      display: inline-block;
      vertical-align: bottom;
      margin: 0 2px;
    }
    .text-container .input-container input {
      border: none;
      border-bottom: 2px solid #ccc;
      font-size: 16px;
      padding: 2px 15px 2px 4px;
      background: transparent;
      outline: none;
      text-align: center;
      font-family: 'Poppins', sans-serif;
    }
    .text-container .input-container .error-icon,
    .text-container .input-container .success-icon {
      top: 50%;
      transform: translateY(-50%);
      font-size: 14px;
    }
    .correct {
      border-bottom: 2px solid #28a745 !important;
    }
    .incorrect {
      border-bottom: 2px solid #dc3545 !important;
    }
    /* Specific widths for fill-ins */
    .text-container input#word1 { width: 120px; }
    .text-container input#word2 { width: 220px; }
    .text-container input#word3 { width: 120px; }
    .text-container input#word4 { width: 120px; }
    .text-container input#word5 { width: 120px; }
    .text-container input#word6 { width: 130px; }

    /* Part 4 Sentence Creation styling (similar to fill in the blanks) */
    .sentence-creation-container {
      margin-bottom: 10px;
    }
    .sentence-creation-container label {
      display: block;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 5px;
      font-size: 15px;
      font-family: 'Poppins', sans-serif;
    }
    .sentence-creation-container textarea {
      width: 100%;
      border: none;
      border-bottom: 2px solid #ccc;
      font-size: 15px;
      padding: 5px 0 5px 5px;
      resize: none;
      outline: none;
      font-family: 'Poppins', sans-serif;
    }
    .sentence-creation-container textarea.incorrect-border {
      border-bottom: 2px solid #dc3545 !important;
    }
    /* Error hint box for incorrect sentences */
    .error-hint {
      display: none; /* shown only if incorrect */
      border: 2px solid #dc3545;
      background-color: #eee;
      color: #000;
      padding: 10px;
      margin-top: 5px;
      border-radius: 5px;
      font-size: 14px;
      font-family: 'Poppins', sans-serif;
    }

    /* Buttons */
    .buttons-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 20px auto;
      padding: 0 20px;
      max-width: 500px;
    }
    .btn {
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      transition: all 0.2s ease;
      width: 120px;
      white-space: nowrap;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-family: 'Poppins', sans-serif;
    }
    .btn:active {
      transform: scale(0.95);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
    }
    #submit-btn {
      background: #28a745; 
      color: #ffffff;
    }
    #submit-btn:hover {
      background-color: #1e7e34; 
    }
    #show-answers-btn {
      background: #007bff;
      color: #ffffff;
      opacity: 0;
      width: 0;
      padding: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    #show-answers-btn:hover {
      background-color: #0056b3; 
    }
    #show-answers-btn.visible {
      opacity: 1;
      width: 180px;
      padding: 8px 14px;
      pointer-events: auto;
    }

    /* Results text */
    #results {
      text-align: center;
      margin: 20px 0;
      min-height: 27px;
      font-size: 16px;
      font-weight: bold;
      color: #28a745;
      font-family: 'Poppins', sans-serif;
    }

    /* Loading overlay */
    #loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    #loading-overlay p {
      font-size: 18px;
      font-weight: 600;
      color: #555;
      font-family: 'Poppins', sans-serif;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      .question-title {
        font-size: 16px;
      }
      .question p {
        font-size: 14px;
      }
      .btn {
        width: 110px;
        font-size: 13px;
      }
      #show-answers-btn.visible {
        width: 110px;
      }
      .options label {
        font-size: 13px;
      }
    }
    @media (max-width: 480px) {
      .buttons-container {
        gap: 8px;
      }
      .btn {
        width: 100px;
        font-size: 12px;
      }
      #show-answers-btn.visible { 
        width: 130px;
      }
      .sentence-creation-container label {
        font-size: 14px;
      }
      .sentence-creation-container textarea {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>

  <!-- Loading overlay -->
  <div id="loading-overlay">
    <p>Checking your sentences...</p>
  </div>

  <h1>English Grammar Test</h1>

  <!-- Full name or username (rounded, pretty) -->
  <div class="user-info">
    <label for="userName">Please enter your full name or username (@):</label><br>
    <input type="text" id="userName" name="userName" placeholder="e.g. @john123">
  </div>

  <!-- Part 1 + Part 2 -->
  <div class="quiz-container">
    <div class="question-title">Part 1: Multiple Choice</div>

    <div class="question" id="question1">
      <p>Piece of cake</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q1" value="a"> a) A difficult task</label>
        <label><input type="radio" name="q1" value="b"> b) An easy or simple task</label>
        <label><input type="radio" name="q1" value="c"> c) A complex process</label>
        <label><input type="radio" name="q1" value="d"> d) Something that requires a lot of effort</label>
      </div>
    </div>
    <div class="question" id="question2">
      <p>Look forward to</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q2" value="a"> a) To dread an upcoming event</label>
        <label><input type="radio" name="q2" value="b"> b) To eagerly anticipate something</label>
        <label><input type="radio" name="q2" value="c"> c) To forget about the future</label>
        <label><input type="radio" name="q2" value="d"> d) To avoid planning ahead</label>
      </div>
    </div>
    <div class="question" id="question3">
      <p>Hit the books</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q3" value="a"> a) To study hard or intensely</label>
        <label><input type="radio" name="q3" value="b"> b) To destroy something out of frustration</label>
        <label><input type="radio" name="q3" value="c"> c) To ignore academic responsibilities</label>
        <label><input type="radio" name="q3" value="d"> d) To skip studying altogether</label>
      </div>
    </div>
    <div class="question" id="question4">
      <p>Give someone a hand</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q4" value="a"> a) To criticize someone</label>
        <label><input type="radio" name="q4" value="b"> b) To help someone with a task</label>
        <label><input type="radio" name="q4" value="c"> c) To compete with someone</label>
        <label><input type="radio" name="q4" value="d"> d) To withdraw support</label>
      </div>
    </div>
    <div class="question" id="question5">
      <p>Call it a day</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q5" value="a"> a) To end work or an activity for the day</label>
        <label><input type="radio" name="q5" value="b"> b) To start a new task</label>
        <label><input type="radio" name="q5" value="c"> c) To delay an important decision</label>
        <label><input type="radio" name="q5" value="d"> d) To work late into the night</label>
      </div>
    </div>
    <div class="question" id="question6">
      <p>On the same page</p>
      <span class="error-icon">✘</span>
      <span class="success-icon">✓</span>
      <div class="options">
        <label><input type="radio" name="q6" value="a"> a) To be in agreement or understanding with others</label>
        <label><input type="radio" name="q6" value="b"> b) To have different opinions</label>
        <label><input type="radio" name="q6" value="c"> c) To argue about a plan or idea</label>
        <label><input type="radio" name="q6" value="d"> d) To work in isolation</label>
      </div>
    </div>

    <div class="question-title">Part 2: Fill in the Blanks</div>
    <div class="text-container">
      <p>
        1. This assignment was a 
        <div class="input-container">
          <input type="text" id="word1" data-correct="piece of cake">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        . I finished it in less than an hour.
      </p>
      <br><br>
      <p>
        2. I really 
        <div class="input-container">
          <input type="text" id="word2" data-correct="look forward to visiting my grandparents">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        this weekend—it’s been so long since I last saw them.
      </p>
      <br><br>
      <p>
        3. With exams coming up, it’s time to
        <div class="input-container">
          <input type="text" id="word3" data-correct="hit the books">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        and prepare thoroughly.
      </p>
      <br><br>
      <p>
        4. Could you
        <div class="input-container">
          <input type="text" id="word4" data-correct="give me a hand">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        and help me carry these boxes upstairs?
      </p>
      <br><br>
      <p>
        5. It’s getting late, so let’s
        <div class="input-container">
          <input type="text" id="word5" data-correct="call it a day">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        and continue tomorrow.
      </p>
      <br><br>
      <p>
        6. Before we finalize the proposal, let’s make sure we’re all
        <div class="input-container">
          <input type="text" id="word6" data-correct="on the same page">
          <span class="error-icon">✘</span>
          <span class="success-icon">✓</span>
        </div>
        about the budget details.
      </p>
    </div>
  </div>

  <!-- Part 4: Sentence Creation -->
  <div class="quiz-container">
    <div class="question-title">Part 3: Sentence Creation</div>
    <p style="text-align:center;">
      Create your own sentences using the following idioms.
      <br>(They will be checked for correct usage and grammar.)
    </p>

    <div class="sentence-creation-container" id="idiom1-container">
      <label>Piece of cake:</label>
      <textarea id="sentence1" rows="2"></textarea>
      <div class="error-hint" id="idiom1-hint"></div>
    </div>
    <div class="sentence-creation-container" id="idiom2-container">
      <label>Look forward to:</label>
      <textarea id="sentence2" rows="2"></textarea>
      <div class="error-hint" id="idiom2-hint"></div>
    </div>
    <div class="sentence-creation-container" id="idiom3-container">
      <label>Hit the books:</label>
      <textarea id="sentence3" rows="2"></textarea>
      <div class="error-hint" id="idiom3-hint"></div>
    </div>
    <div class="sentence-creation-container" id="idiom4-container">
      <label>Give someone a hand:</label>
      <textarea id="sentence4" rows="2"></textarea>
      <div class="error-hint" id="idiom4-hint"></div>
    </div>
    <div class="sentence-creation-container" id="idiom5-container">
      <label>Call it a day:</label>
      <textarea id="sentence5" rows="2"></textarea>
      <div class="error-hint" id="idiom5-hint"></div>
    </div>
    <div class="sentence-creation-container" id="idiom6-container">
      <label>On the same page:</label>
      <textarea id="sentence6" rows="2"></textarea>
      <div class="error-hint" id="idiom6-hint"></div>
    </div>
  </div>

  <!-- Submission + Show Answers Buttons -->
  <div class="buttons-container">
    <button id="submit-btn" class="btn">Submit</button>
    <button id="show-answers-btn" class="btn">Show Answers</button>
  </div>

  <!-- Results placeholder -->
  <div id="results"></div>

  <script>
    /* -----------------------------------------------------------------
       1) Basic Setup & DOM references
       ----------------------------------------------------------------- */
    const submitBtn = document.getElementById('submit-btn');
    const showAnswersBtn = document.getElementById('show-answers-btn');
    const resultsDiv = document.getElementById('results');
    const questions = document.querySelectorAll('.question');
    const textContainer = document.querySelector('.text-container');
    const loadingOverlay = document.getElementById('loading-overlay');

    // Multiple choice correct answers
    const correctAnswers = {
      q1: 'b',
      q2: 'b',
      q3: 'a',
      q4: 'b',
      q5: 'a',
      q6: 'a'
    };

    // Fill-in-the-blanks references
    const textInputFields = textContainer.querySelectorAll('.input-container input');

    // Part 4 references
    const sentenceFields = [
      { textarea: document.getElementById('sentence1'), container: document.getElementById('idiom1-container'), hint: document.getElementById('idiom1-hint') },
      { textarea: document.getElementById('sentence2'), container: document.getElementById('idiom2-container'), hint: document.getElementById('idiom2-hint') },
      { textarea: document.getElementById('sentence3'), container: document.getElementById('idiom3-container'), hint: document.getElementById('idiom3-hint') },
      { textarea: document.getElementById('sentence4'), container: document.getElementById('idiom4-container'), hint: document.getElementById('idiom4-hint') },
      { textarea: document.getElementById('sentence5'), container: document.getElementById('idiom5-container'), hint: document.getElementById('idiom5-hint') },
      { textarea: document.getElementById('sentence6'), container: document.getElementById('idiom6-container'), hint: document.getElementById('idiom6-hint') },
    ];

    let isShowingAnswers = false;

    /* -----------------------------------------------------------------
       2) Check Part 1 & Part 2 on client side
       ----------------------------------------------------------------- */
       function checkPart1AndPart2() {
        let correctRadioCount = 0;
        const totalRadioQuestions = questions.length;
        let correctTextCount = 0;
        const totalTextQuestions = textInputFields.length;

        // Check multiple choice
        questions.forEach((question, index) => {
            const questionName = `q${index + 1}`;
            const selectedOption = document.querySelector(`input[name="${questionName}"]:checked`);
            const userAnswer = selectedOption ? selectedOption.value : null;
            const errorIcon = question.querySelector('.error-icon');
            const successIcon = question.querySelector('.success-icon');

            if (userAnswer === correctAnswers[questionName]) {
                correctRadioCount++;
                if (successIcon) successIcon.style.display = 'inline';
                if (errorIcon) errorIcon.style.display = 'none';
            } else {
                if (errorIcon) errorIcon.style.display = 'inline';
                if (successIcon) successIcon.style.display = 'none';
            }
        });

        // Check fill-in-the-blanks
        textInputFields.forEach(input => {
            const userAnswer = input.value.trim().toLowerCase();
            const correctAnswer = input.getAttribute('data-correct').toLowerCase();
            const container = input.parentElement;
            const errorIcon = container.querySelector('.error-icon');
            const successIcon = container.querySelector('.success-icon');

            if (userAnswer === correctAnswer) {
                correctTextCount++;
                input.classList.add('correct');
                input.classList.remove('incorrect');
                errorIcon.style.display = 'none';
                successIcon.style.display = 'inline';
            } else {
                input.classList.add('incorrect');
                input.classList.remove('correct');
                errorIcon.style.display = 'inline';
                successIcon.style.display = 'none';
            }
        });

        return { correctRadioCount, correctTextCount, totalRadioQuestions, totalTextQuestions };
    }

    /* -----------------------------------------------------------------
       3) Check Part 4 sentences with GPT-4o-mini 
          (client-side call to OpenAI; not recommended for production)
       ----------------------------------------------------------------- */
       async function checkPart4WithGPT4OMini(allSentences) {
        loadingOverlay.style.display = 'flex';

        const apiKey = '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'; // Replace with your actual API key
        const apiUrl = 'https://api.openai.com/v1/chat/completions';

        const systemMessage = `You are an English teacher checking idiom usage and grammar. Check these sentences and respond with a JSON array where each element is an object with "correct" (boolean) and "feedback" (string). Example: [{"correct":true,"feedback":""},{"correct":false,"feedback":"Incorrect usage of the idiom"}]`;

        const userMessage = allSentences.join('\n');

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: "gpt-4",  // or your specific model
                    messages: [
                        { role: "system", content: systemMessage },
                        { role: "user", content: userMessage }
                    ],
                    temperature: 0.3
                })
            });

            if (!response.ok) {
                throw new Error('API request failed');
            }

            const data = await response.json();
            let results;
            
            try {
                // Try to parse the response content as JSON
                results = JSON.parse(data.choices[0].message.content);
            } catch (e) {
                // If parsing fails, create a structured response
                results = allSentences.map(sentence => ({
                    correct: sentence.length > 0,  // Consider non-empty sentences as correct
                    feedback: sentence.length > 0 ? "" : "Please enter a sentence"
                }));
            }

            return results;

        } catch (error) {
            console.error("Error:", error);
            return allSentences.map(sentence => ({
                correct: sentence.length > 0,
                feedback: sentence.length > 0 ? "" : "Please enter a sentence"
            }));
        } finally {
            loadingOverlay.style.display = 'none';
        }
    }

    /* -----------------------------------------------------------------
       4) Store data in Google Forms (placeholder)
       ----------------------------------------------------------------- */
    function storeInGoogleForm(payload) {
      // Example form. You must create questions in your Google Form, 
      // find the "entry.<ID>" for each field, and append them here.

      // Replace with your actual form's POST URL:
      const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSdeyO7hMJCuoIi_ePsPWXWAuaANtV5GaAhsplyXo4M3wVN8hg/formResponse";

      const formData = new FormData();
      // For example:
      // formData.append('entry.1111111111', payload.userName);
      // formData.append('entry.2222222222', payload.scoreSummary);
      // formData.append('entry.3333333333', JSON.stringify(payload.sentenceFeedback));

      // This is just demonstration:
      formData.append('entry.1234567890', payload.userName || "");
      formData.append('entry.1234567891', payload.scoreSummary || "");
      formData.append('entry.1234567892', JSON.stringify(payload.sentenceFeedback));

      fetch(formUrl, {
        method: 'POST',
        mode: 'no-cors',
        body: formData
      })
      .then(() => {
        console.log("Data sent to Google Form.");
      })
      .catch(err => {
        console.error("Error sending to Google Form:", err);
      });
    }

    /* -----------------------------------------------------------------
       5) Submit Handler
       ----------------------------------------------------------------- */
    

    async function handleSubmission() {
        submitBtn.disabled = true;
        submitBtn.style.cursor = 'not-allowed';
        submitBtn.style.opacity = '0.6';

        // Check Part 1 + Part 2
        const p1p2Result = checkPart1AndPart2();

        // Get sentences from Part 4
        const sentences = sentenceFields.map(sf => sf.textarea.value.trim());
        const nonEmptySentences = sentences.filter(s => s.length > 0);
        
        // Check Part 4
        const checkResults = await checkPart4WithGPT4OMini(sentences);
        
        // Calculate Part 4 score
        const correctSentences = checkResults.filter(r => r.correct).length;
        
        // Update UI for Part 4
        let anyIncorrect = false;
        checkResults.forEach((r, idx) => {
            const { textarea, hint } = sentenceFields[idx];
            if (r.correct) {
                textarea.classList.remove('incorrect-border');
                hint.style.display = 'none';
            } else {
                textarea.classList.add('incorrect-border');
                hint.style.display = 'block';
                hint.innerText = r.feedback;
                anyIncorrect = true;
            }
        });

        // Calculate total score
        const totalCorrect = p1p2Result.correctRadioCount + p1p2Result.correctTextCount + correctSentences;
        const totalQuestions = p1p2Result.totalRadioQuestions + p1p2Result.totalTextQuestions + sentences.length;
        const percentage = Math.round((totalCorrect / totalQuestions) * 100);

        // Show results
        let resultMessage = `Total Score: ${totalCorrect} out of ${totalQuestions} (${percentage}%)\n`;
        resultMessage += `Multiple Choice: ${p1p2Result.correctRadioCount}/${p1p2Result.totalRadioQuestions}\n`;
        resultMessage += `Fill in the Blanks: ${p1p2Result.correctTextCount}/${p1p2Result.totalTextQuestions}\n`;
        resultMessage += `Sentence Creation: ${correctSentences}/${sentences.length}`;
        
        resultsDiv.innerHTML = resultMessage.replace(/\n/g, '<br>');

        // Show answers button
        showAnswersBtn.classList.add('visible');

        // Store results
        const userName = document.getElementById('userName').value || "Unknown";
        storeInGoogleForm({
            userName,
            scoreSummary: `${totalCorrect}/${totalQuestions} (${percentage}%)`,
            sentenceFeedback: checkResults
        });
    }

    /* -----------------------------------------------------------------
       6) Show/Hide Correct Answers
       ----------------------------------------------------------------- */
    function toggleCorrectAnswers() {
      isShowingAnswers = !isShowingAnswers;
      showAnswersBtn.textContent = isShowingAnswers ? 'Hide Answers' : 'Show Answers';

      // Part 1
      questions.forEach((question, index) => {
        const questionName = `q${index + 1}`;
        const radios = question.querySelectorAll('input[type="radio"]');
        if (isShowingAnswers) {
          // Show correct
          radios.forEach(r => {
            r.checked = (r.value === correctAnswers[questionName]);
          });
        } else {
          // Uncheck or revert
          radios.forEach(r => {
            r.checked = false;
          });
        }
      });

      // Part 2
      textInputFields.forEach(input => {
        if (isShowingAnswers) {
          input.value = input.getAttribute('data-correct');
        } else {
          input.value = '';
        }
      });
    }

    /* -----------------------------------------------------------------
       7) Event Listeners
       ----------------------------------------------------------------- */
    submitBtn.addEventListener('click', handleSubmission);
    showAnswersBtn.addEventListener('click', toggleCorrectAnswers);
  </script>
</body>
</html>
